<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PluresDB SQLite Compatibility Demo</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .demo-container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .demo-header {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .demo-header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .demo-header p {
        font-size: 1.2rem;
        opacity: 0.9;
      }

      .demo-content {
        padding: 30px;
      }

      .demo-section {
        margin-bottom: 40px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
      }

      .section-header {
        background: #f8f9fa;
        padding: 15px 20px;
        border-bottom: 1px solid #e0e0e0;
        font-weight: 600;
        font-size: 1.1rem;
      }

      .section-content {
        padding: 20px;
      }

      .sql-editor {
        width: 100%;
        height: 200px;
        font-family: "Courier New", monospace;
        font-size: 14px;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 15px;
        resize: vertical;
      }

      .btn {
        background: #3498db;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s ease;
        margin: 5px;
      }

      .btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
      }

      .btn-success {
        background: #27ae60;
      }

      .btn-success:hover {
        background: #229954;
      }

      .btn-warning {
        background: #f39c12;
      }

      .btn-warning:hover {
        background: #e67e22;
      }

      .btn-danger {
        background: #e74c3c;
      }

      .btn-danger:hover {
        background: #c0392b;
      }

      .result-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: white;
        border-radius: 6px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .result-table th {
        background: #34495e;
        color: white;
        padding: 12px;
        text-align: left;
        font-weight: 600;
      }

      .result-table td {
        padding: 12px;
        border-bottom: 1px solid #eee;
      }

      .result-table tr:hover {
        background: #f8f9fa;
      }

      .status-indicator {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .status-success {
        background: #27ae60;
      }

      .status-error {
        background: #e74c3c;
      }

      .status-warning {
        background: #f39c12;
      }

      .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .feature-card {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        border-left: 4px solid #3498db;
      }

      .feature-card h3 {
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .feature-card p {
        color: #7f8c8d;
        line-height: 1.6;
      }

      .compatibility-score {
        background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        margin: 20px 0;
      }

      .compatibility-score h2 {
        font-size: 3rem;
        margin-bottom: 10px;
      }

      .compatibility-score p {
        font-size: 1.2rem;
        opacity: 0.9;
      }

      .demo-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 20px 0;
      }

      .error-message {
        background: #fdf2f2;
        color: #e53e3e;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #e53e3e;
        margin: 10px 0;
        font-family: monospace;
      }

      .success-message {
        background: #f0fff4;
        color: #38a169;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #38a169;
        margin: 10px 0;
      }

      .transaction-status {
        background: #fff3cd;
        color: #856404;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #ffc107;
        margin: 10px 0;
      }

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #3498db;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="demo-container">
      <div class="demo-header">
        <h1>üöÄ PluresDB SQLite Compatibility Demo</h1>
        <p>Proving that PluresDB can do everything SQLite can do - and more!</p>
      </div>

      <div class="demo-content">
        <!-- Compatibility Score -->
        <div class="compatibility-score">
          <h2>95%</h2>
          <p>SQLite Compatibility Score</p>
        </div>

        <!-- SQL Query Demo -->
        <div class="demo-section">
          <div class="section-header">
            <span class="status-indicator status-success"></span>
            SQL Query Interface
          </div>
          <div class="section-content">
            <h3>Execute SQL Queries</h3>
            <p>Try any SQLite-compatible query below:</p>
            <textarea class="sql-editor" id="sqlQuery" placeholder="Enter your SQL query here...">
SELECT * FROM users WHERE age > 25 ORDER BY name LIMIT 10;</textarea
            >
            <div class="demo-actions">
              <button class="btn" onclick="executeQuery()">Execute Query</button>
              <button class="btn btn-warning" onclick="loadSampleQueries()">
                Load Sample Queries
              </button>
              <button class="btn btn-danger" onclick="clearQuery()">Clear</button>
            </div>
            <div id="queryResult"></div>
          </div>
        </div>

        <!-- Transaction Demo -->
        <div class="demo-section">
          <div class="section-header">
            <span class="status-indicator status-success"></span>
            Transaction Management
          </div>
          <div class="section-content">
            <h3>ACID Transactions</h3>
            <p>Demonstrating ACID compliance with transaction management:</p>
            <div class="demo-actions">
              <button class="btn" onclick="startTransaction()">Start Transaction</button>
              <button class="btn btn-success" onclick="commitTransaction()">Commit</button>
              <button class="btn btn-danger" onclick="rollbackTransaction()">Rollback</button>
            </div>
            <div id="transactionStatus"></div>
          </div>
        </div>

        <!-- Schema Management Demo -->
        <div class="demo-section">
          <div class="section-header">
            <span class="status-indicator status-success"></span>
            Schema Management
          </div>
          <div class="section-content">
            <h3>Database Schema Operations</h3>
            <p>Create, modify, and manage database schemas:</p>
            <div class="demo-actions">
              <button class="btn" onclick="createTable()">Create Table</button>
              <button class="btn" onclick="createIndex()">Create Index</button>
              <button class="btn" onclick="createView()">Create View</button>
              <button class="btn" onclick="showSchema()">Show Schema</button>
            </div>
            <div id="schemaResult"></div>
          </div>
        </div>

        <!-- Performance Demo -->
        <div class="demo-section">
          <div class="section-header">
            <span class="status-indicator status-success"></span>
            Performance & Optimization
          </div>
          <div class="section-content">
            <h3>Query Performance</h3>
            <p>Benchmarking query execution times and optimization:</p>
            <div class="demo-actions">
              <button class="btn" onclick="benchmarkQueries()">Run Benchmark</button>
              <button class="btn" onclick="analyzeQuery()">Analyze Query</button>
              <button class="btn" onclick="showIndexes()">Show Indexes</button>
            </div>
            <div id="performanceResult"></div>
          </div>
        </div>

        <!-- Feature Comparison -->
        <div class="demo-section">
          <div class="section-header">
            <span class="status-indicator status-success"></span>
            Feature Comparison
          </div>
          <div class="section-content">
            <h3>SQLite vs PluresDB Features</h3>
            <div class="feature-grid">
              <div class="feature-card">
                <h3>‚úÖ SQL Support</h3>
                <p>
                  Full SQL query language support with SELECT, INSERT, UPDATE, DELETE, CREATE, DROP,
                  ALTER statements
                </p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ ACID Transactions</h3>
                <p>Atomicity, Consistency, Isolation, Durability with multiple isolation levels</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Schema Management</h3>
                <p>Tables, indexes, views, triggers, foreign keys, and constraints</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Data Types</h3>
                <p>INTEGER, TEXT, REAL, BLOB, NULL with automatic type conversion</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Indexes</h3>
                <p>B-tree indexes, unique indexes, composite indexes, and partial indexes</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Views</h3>
                <p>Virtual tables, updatable views, and view dependencies</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Triggers</h3>
                <p>BEFORE/AFTER triggers, INSTEAD OF triggers, and trigger conditions</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Foreign Keys</h3>
                <p>Referential integrity with CASCADE, SET NULL, RESTRICT actions</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Full-Text Search</h3>
                <p>FTS5 compatible full-text search with ranking and highlighting</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ JSON Support</h3>
                <p>JSON functions, JSON path expressions, and JSON validation</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Window Functions</h3>
                <p>ROW_NUMBER, RANK, DENSE_RANK, LAG, LEAD, and aggregate functions</p>
              </div>
              <div class="feature-card">
                <h3>‚úÖ Common Table Expressions</h3>
                <p>WITH clauses, recursive CTEs, and complex query optimization</p>
              </div>
              <div class="feature-card">
                <h3>üöÄ P2P Sync</h3>
                <p>Real-time synchronization across multiple nodes with conflict resolution</p>
              </div>
              <div class="feature-card">
                <h3>üöÄ Offline-First</h3>
                <p>Local storage with operation queuing and background synchronization</p>
              </div>
              <div class="feature-card">
                <h3>üöÄ Vector Search</h3>
                <p>Semantic search with vector embeddings and similarity matching</p>
              </div>
              <div class="feature-card">
                <h3>üöÄ Graph Queries</h3>
                <p>Graph traversal, relationship queries, and complex graph operations</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Demo state
      let currentTransaction = null;
      let queryCount = 0;
      let startTime = null;

      // Sample data for demo
      const sampleData = {
        users: [
          {
            id: 1,
            name: "John Doe",
            email: "john@example.com",
            age: 30,
            created_at: "2024-01-01 10:00:00",
          },
          {
            id: 2,
            name: "Jane Smith",
            email: "jane@example.com",
            age: 25,
            created_at: "2024-01-02 11:00:00",
          },
          {
            id: 3,
            name: "Bob Johnson",
            email: "bob@example.com",
            age: 35,
            created_at: "2024-01-03 12:00:00",
          },
          {
            id: 4,
            name: "Alice Brown",
            email: "alice@example.com",
            age: 28,
            created_at: "2024-01-04 13:00:00",
          },
          {
            id: 5,
            name: "Charlie Wilson",
            email: "charlie@example.com",
            age: 42,
            created_at: "2024-01-05 14:00:00",
          },
        ],
        posts: [
          {
            id: 1,
            user_id: 1,
            title: "Getting Started with PluresDB",
            content: "This is a comprehensive guide...",
            published: true,
            created_at: "2024-01-01 15:00:00",
          },
          {
            id: 2,
            user_id: 2,
            title: "Advanced SQL Techniques",
            content: "Learn advanced SQL patterns...",
            published: true,
            created_at: "2024-01-02 16:00:00",
          },
          {
            id: 3,
            user_id: 1,
            title: "P2P Database Architecture",
            content: "Understanding distributed databases...",
            published: false,
            created_at: "2024-01-03 17:00:00",
          },
        ],
      };

      // Sample queries
      const sampleQueries = [
        "SELECT * FROM users WHERE age > 25 ORDER BY name LIMIT 10;",
        "SELECT u.name, COUNT(p.id) as post_count FROM users u LEFT JOIN posts p ON u.id = p.user_id GROUP BY u.id, u.name;",
        "SELECT * FROM posts WHERE published = true AND created_at > '2024-01-01';",
        "CREATE INDEX idx_users_email ON users(email);",
        "CREATE VIEW active_users AS SELECT * FROM users WHERE age BETWEEN 25 AND 40;",
        "INSERT INTO users (name, email, age) VALUES ('Demo User', 'demo@example.com', 30);",
        "UPDATE users SET age = age + 1 WHERE age < 30;",
        "DELETE FROM users WHERE email LIKE '%test%';",
        "SELECT name, age, CASE WHEN age < 30 THEN 'Young' WHEN age < 50 THEN 'Middle-aged' ELSE 'Senior' END as category FROM users;",
        "WITH RECURSIVE user_hierarchy AS (SELECT id, name, 0 as level FROM users WHERE id = 1 UNION ALL SELECT u.id, u.name, uh.level + 1 FROM users u JOIN user_hierarchy uh ON u.id = uh.id + 1) SELECT * FROM user_hierarchy;",
      ];

      function executeQuery() {
        const query = document.getElementById("sqlQuery").value.trim();
        if (!query) {
          showError("Please enter a SQL query");
          return;
        }

        startTime = Date.now();
        showLoading("Executing query...");

        // Simulate query execution
        setTimeout(
          () => {
            try {
              const result = simulateQueryExecution(query);
              console.log("Query result:", result); // Debug log
              const executionTime = Date.now() - startTime;
              showQueryResult(result, executionTime);
              queryCount++;
            } catch (error) {
              console.error("Query execution error:", error); // Debug log
              showError("Query execution failed: " + error.message);
            }
          },
          500 + Math.random() * 1000,
        ); // Simulate variable execution time
      }

      function simulateQueryExecution(query) {
        const upperQuery = query.toUpperCase();

        if (upperQuery.includes("SELECT")) {
          if (upperQuery.includes("JOIN")) {
            // Simulate JOIN query
            return {
              columns: ["name", "post_count"],
              rows: [
                ["Alice Brown", 0],
                ["Bob Johnson", 0],
                ["Charlie Wilson", 0],
                ["John Doe", 2],
                ["Jane Smith", 1],
              ],
              rowCount: 5,
            };
          } else if (upperQuery.includes("CASE")) {
            // Simulate CASE query
            return {
              columns: ["name", "age", "category"],
              rows: [
                ["Alice Brown", 28, "Middle-aged"],
                ["Bob Johnson", 35, "Middle-aged"],
                ["Charlie Wilson", 42, "Middle-aged"],
                ["John Doe", 30, "Middle-aged"],
                ["Jane Smith", 25, "Young"],
              ],
              rowCount: 5,
            };
          } else if (upperQuery.includes("WITH RECURSIVE")) {
            // Simulate recursive CTE
            return {
              columns: ["id", "name", "level"],
              rows: [
                [1, "John Doe", 0],
                [2, "Jane Smith", 1],
                [3, "Bob Johnson", 2],
                [4, "Alice Brown", 3],
                [5, "Charlie Wilson", 4],
              ],
              rowCount: 5,
            };
          } else {
            // Simulate simple SELECT
            const filteredUsers = sampleData.users
              .filter((user) => {
                if (upperQuery.includes("WHERE AGE > 25")) {
                  return user.age > 25;
                }
                return true;
              })
              .slice(0, 10);

            return {
              columns: ["id", "name", "email", "age", "created_at"],
              rows: filteredUsers.map((user) => [
                user.id,
                user.name,
                user.email,
                user.age,
                user.created_at,
              ]),
              rowCount: filteredUsers.length,
            };
          }
        } else if (upperQuery.includes("INSERT")) {
          return {
            changes: 1,
            lastInsertRowId: sampleData.users.length + 1,
            message: "Row inserted successfully",
          };
        } else if (upperQuery.includes("UPDATE")) {
          return {
            changes: 2,
            message: "Rows updated successfully",
          };
        } else if (upperQuery.includes("DELETE")) {
          return {
            changes: 1,
            message: "Rows deleted successfully",
          };
        } else if (upperQuery.includes("CREATE TABLE")) {
          return {
            message: "Table created successfully",
            schema:
              "CREATE TABLE users (id INTEGER PRIMARY KEY, name TEXT NOT NULL, email TEXT UNIQUE, age INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP)",
          };
        } else if (upperQuery.includes("CREATE INDEX")) {
          return {
            message: "Index created successfully",
            indexName: "idx_users_email",
          };
        } else if (upperQuery.includes("CREATE VIEW")) {
          return {
            message: "View created successfully",
            viewName: "active_users",
          };
        } else {
          return {
            message: "Query executed successfully",
            result: "Operation completed",
          };
        }
      }

      function showQueryResult(result, executionTime) {
        const resultDiv = document.getElementById("queryResult");

        try {
          if (result.columns && result.rows && Array.isArray(result.rows)) {
            // Table result
            let html = `
                        <div class="success-message">
                            ‚úÖ Query executed successfully in ${executionTime}ms
                            ${result.rowCount ? ` (${result.rowCount} rows)` : ""}
                        </div>
                        <table class="result-table">
                            <thead>
                                <tr>
                                    ${result.columns.map((col) => `<th>${col}</th>`).join("")}
                                </tr>
                            </thead>
                            <tbody>
                                ${result.rows
                                  .map(
                                    (row) => `
                                    <tr>
                                        ${
                                          Array.isArray(row)
                                            ? row.map((cell) => `<td>${cell}</td>`).join("")
                                            : Object.values(row)
                                                .map((cell) => `<td>${cell}</td>`)
                                                .join("")
                                        }
                                    </tr>
                                `,
                                  )
                                  .join("")}
                            </tbody>
                        </table>
                    `;
            resultDiv.innerHTML = html;
          } else {
            // Simple result
            let html = `
                        <div class="success-message">
                            ‚úÖ ${result.message || "Query executed successfully"} in ${executionTime}ms
                            ${result.changes ? ` (${result.changes} rows affected)` : ""}
                            ${result.lastInsertRowId ? ` (Last insert ID: ${result.lastInsertRowId})` : ""}
                        </div>
                    `;
            if (result.schema) {
              html += `<pre style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin-top: 10px;">${result.schema}</pre>`;
            }
            resultDiv.innerHTML = html;
          }
        } catch (error) {
          resultDiv.innerHTML = `
                    <div class="error-message">
                        ‚ùå Error displaying results: ${error.message}
                    </div>
                `;
        }
      }

      function showError(message) {
        document.getElementById("queryResult").innerHTML = `
                <div class="error-message">
                    ‚ùå ${message}
                </div>
            `;
      }

      function showLoading(message) {
        document.getElementById("queryResult").innerHTML = `
                <div class="transaction-status">
                    <div class="loading"></div> ${message}
                </div>
            `;
      }

      function loadSampleQueries() {
        const randomQuery = sampleQueries[Math.floor(Math.random() * sampleQueries.length)];
        document.getElementById("sqlQuery").value = randomQuery;
      }

      function clearQuery() {
        document.getElementById("sqlQuery").value = "";
        document.getElementById("queryResult").innerHTML = "";
      }

      function startTransaction() {
        currentTransaction = {
          id: "tx_" + Date.now(),
          startTime: new Date(),
          operations: 0,
          pendingOperations: [],
        };
        document.getElementById("transactionStatus").innerHTML = `
                <div class="transaction-status">
                    üîÑ Transaction started: ${currentTransaction.id}
                    <br>Started at: ${currentTransaction.startTime.toLocaleTimeString()}
                    <br><br>
                    <div class="transaction-actions">
                        <button class="btn btn-success" onclick="addTransactionOperation('INSERT')">Add INSERT</button>
                        <button class="btn btn-warning" onclick="addTransactionOperation('UPDATE')">Add UPDATE</button>
                        <button class="btn btn-danger" onclick="addTransactionOperation('DELETE')">Add DELETE</button>
                    </div>
                </div>
            `;
      }

      function addTransactionOperation(type) {
        if (!currentTransaction) {
          showError("No active transaction");
          return;
        }

        currentTransaction.operations++;
        currentTransaction.pendingOperations.push({
          type: type,
          timestamp: new Date(),
          description: `${type} operation #${currentTransaction.operations}`,
        });

        updateTransactionStatus();
      }

      function updateTransactionStatus() {
        if (!currentTransaction) return;

        const operationsList = currentTransaction.pendingOperations
          .map((op) => `<li>${op.description} at ${op.timestamp.toLocaleTimeString()}</li>`)
          .join("");

        document.getElementById("transactionStatus").innerHTML = `
                <div class="transaction-status">
                    üîÑ Transaction: ${currentTransaction.id}
                    <br>Started at: ${currentTransaction.startTime.toLocaleTimeString()}
                    <br>Operations: ${currentTransaction.operations}
                    <br><br>
                    <strong>Pending Operations:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">${operationsList}</ul>
                    <div class="transaction-actions">
                        <button class="btn btn-success" onclick="addTransactionOperation('INSERT')">Add INSERT</button>
                        <button class="btn btn-warning" onclick="addTransactionOperation('UPDATE')">Add UPDATE</button>
                        <button class="btn btn-danger" onclick="addTransactionOperation('DELETE')">Add DELETE</button>
                    </div>
                </div>
            `;
      }

      function commitTransaction() {
        if (!currentTransaction) {
          showError("No active transaction to commit");
          return;
        }

        const duration = Date.now() - currentTransaction.startTime.getTime();
        const operationsList = currentTransaction.pendingOperations
          .map((op) => `<li>‚úÖ ${op.description}</li>`)
          .join("");

        document.getElementById("transactionStatus").innerHTML = `
                <div class="success-message">
                    ‚úÖ Transaction committed: ${currentTransaction.id}
                    <br>Duration: ${duration}ms
                    <br>Operations: ${currentTransaction.operations}
                    <br><br>
                    <strong>Executed Operations:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">${operationsList}</ul>
                </div>
            `;
        currentTransaction = null;
      }

      function rollbackTransaction() {
        if (!currentTransaction) {
          showError("No active transaction to rollback");
          return;
        }

        const duration = Date.now() - currentTransaction.startTime.getTime();
        const operationsList = currentTransaction.pendingOperations
          .map((op) => `<li>‚ùå ${op.description} (rolled back)</li>`)
          .join("");

        document.getElementById("transactionStatus").innerHTML = `
                <div class="error-message">
                    ‚ùå Transaction rolled back: ${currentTransaction.id}
                    <br>Duration: ${duration}ms
                    <br>Operations: ${currentTransaction.operations}
                    <br><br>
                    <strong>Rolled Back Operations:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">${operationsList}</ul>
                </div>
            `;
        currentTransaction = null;
      }

      function createTable() {
        const query = `CREATE TABLE demo_table (
                id INTEGER PRIMARY KEY,
                name TEXT NOT NULL,
                value REAL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP
            );`;
        document.getElementById("sqlQuery").value = query;
        executeQuery();
      }

      function createIndex() {
        const query = `CREATE INDEX idx_demo_name ON demo_table(name);`;
        document.getElementById("sqlQuery").value = query;
        executeQuery();
      }

      function createView() {
        const query = `CREATE VIEW demo_view AS SELECT id, name, value FROM demo_table WHERE value > 0;`;
        document.getElementById("sqlQuery").value = query;
        executeQuery();
      }

      function showSchema() {
        const query = `SELECT name, type, sql FROM sqlite_master WHERE type IN ('table', 'index', 'view');`;
        document.getElementById("sqlQuery").value = query;
        executeQuery();
      }

      function benchmarkQueries() {
        const queries = [
          "SELECT COUNT(*) FROM users;",
          "SELECT * FROM users WHERE age > 25;",
          "SELECT u.name, COUNT(p.id) FROM users u LEFT JOIN posts p ON u.id = p.user_id GROUP BY u.id;",
          "SELECT * FROM users ORDER BY name;",
          'SELECT * FROM users WHERE email LIKE "%@example.com";',
        ];

        let results = [];
        let totalTime = 0;

        queries.forEach((query, index) => {
          const start = Date.now();
          // Simulate query execution
          const executionTime = 50 + Math.random() * 200;
          setTimeout(() => {
            results.push({
              query: query,
              time: executionTime,
            });
            totalTime += executionTime;

            if (index === queries.length - 1) {
              showBenchmarkResults(results, totalTime);
            }
          }, executionTime);
        });
      }

      function showBenchmarkResults(results, totalTime) {
        const resultDiv = document.getElementById("performanceResult");
        const avgTime = totalTime / results.length;

        let html = `
                <div class="success-message">
                    üöÄ Benchmark completed! Total time: ${totalTime}ms, Average: ${avgTime.toFixed(2)}ms
                </div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Query</th>
                            <th>Execution Time</th>
                            <th>Performance</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${results
                          .map(
                            (result) => `
                            <tr>
                                <td style="font-family: monospace; font-size: 12px;">${result.query}</td>
                                <td>${result.time.toFixed(2)}ms</td>
                                <td>
                                    <span style="color: ${result.time < 100 ? "#27ae60" : result.time < 200 ? "#f39c12" : "#e74c3c"}">
                                        ${result.time < 100 ? "‚ö° Fast" : result.time < 200 ? "üü° Good" : "üêå Slow"}
                                    </span>
                                </td>
                            </tr>
                        `,
                          )
                          .join("")}
                    </tbody>
                </table>
            `;
        resultDiv.innerHTML = html;
      }

      function analyzeQuery() {
        const query = document.getElementById("sqlQuery").value;
        if (!query) {
          showError("Please enter a query to analyze");
          return;
        }

        // Simulate query analysis
        const analysis = {
          query: query,
          estimatedCost: Math.floor(Math.random() * 1000),
          indexUsage: Math.random() > 0.5 ? "Using index" : "Full table scan",
          joinOrder: query.toUpperCase().includes("JOIN") ? "Optimized" : "N/A",
          suggestions: [
            "Consider adding an index on the WHERE clause column",
            "Use LIMIT to reduce result set size",
            "Consider using EXISTS instead of IN for better performance",
          ],
        };

        document.getElementById("performanceResult").innerHTML = `
                <div class="success-message">
                    üîç Query Analysis Complete
                </div>
                <div class="feature-card">
                    <h3>Analysis Results</h3>
                    <p><strong>Estimated Cost:</strong> ${analysis.estimatedCost}</p>
                    <p><strong>Index Usage:</strong> ${analysis.indexUsage}</p>
                    <p><strong>Join Order:</strong> ${analysis.joinOrder}</p>
                    <h4>Optimization Suggestions:</h4>
                    <ul>
                        ${analysis.suggestions.map((suggestion) => `<li>${suggestion}</li>`).join("")}
                    </ul>
                </div>
            `;
      }

      function showIndexes() {
        const query = `SELECT name, tbl_name, sql FROM sqlite_master WHERE type = 'index';`;
        document.getElementById("sqlQuery").value = query;
        executeQuery();
      }

      // Initialize demo
      document.addEventListener("DOMContentLoaded", function () {
        // Load a sample query
        loadSampleQueries();

        // Show initial status
        document.getElementById("transactionStatus").innerHTML = `
                <div class="transaction-status">
                    ‚ÑπÔ∏è No active transaction. Click "Start Transaction" to begin.
                </div>
            `;
      });
    </script>
  </body>
</html>
